@version: 3.30
@include "scl.conf"

options {
  flush_lines(0);
  time_reopen(10);
  log_fifo_size(1000);
  chain_hostnames(off);
  use_dns(no);
  use_fqdn(no);
  create_dirs(yes);
  keep_hostname(yes);
};

source s_net {
  tcp(port(6601));
  udp(port(5514));
};

destination d_mysql {
  sql(type(mysql)
    username("syslog")
    password("syslogpass")
    database("syslogdb")
    host("db")  # Alias laut docker-compose
    table("logs")
    columns("received_at", "device_reporting", "facility", "priority", "program", "msg", "fromhost", "info_unit_id", "syslogtag")
    values("${S_DATE} ${S_TIME}", "${HOST}", "${FACILITY_NUM}", "${LEVEL_NUM}", "${PROGRAM}", "${MSG}", "${SOURCEIP}", "1", "${PROGRAM}")
    indexes("received_at", "fromhost", "program")
  );
};

log {
  source(s_net);
  destination(d_mysql);
};